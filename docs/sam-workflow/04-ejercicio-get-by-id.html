<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>04 Ejercicio Get By Id - Goikode Serverless Secure Course</title>
    <link rel="stylesheet" href="../styles/goikode-docs.css">
</head>
<body>
    <!-- Header with logo and student prefix -->
    <header class="doc-header">
        <div class="doc-header-left">
            <a href="../index.html" class="logo-link">
                <img src="../assets/brand/logo.svg" alt="Goikode" class="doc-logo" onerror="this.src='../assets/brand/logo.png'">
            </a>
            <h1 class="doc-title">04 Ejercicio Get By Id</h1>
        </div>
        <div class="doc-header-right">
            <div class="student-prefix-display">
                <span class="student-prefix-label">Tu prefijo:</span>
                <span id="header-student-prefix">-</span>
            </div>
            <button id="change-prefix-btn">Cambiar Prefijo</button>
        </div>
    </header>

    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>√çndice del Curso</h2>
            <button class="sidebar-toggle" id="sidebar-toggle">‚úï</button>
        </div>
        <div class="sidebar-content" id="sidebar-content">
            <div class="sidebar-loading">Cargando √≠ndice...</div>
        </div>
    </aside>

    <!-- Toggle button for mobile -->
    <button class="sidebar-open-btn" id="sidebar-open-btn">‚ò∞</button>

    <!-- Main content container -->
    <div class="doc-container with-sidebar">
        <div class="doc-content">
            <h1 id="ejercicio-autonomo-get-vinilosid">Ejercicio Aut√≥nomo: GET /vinilos/{id}</h1>
<h2 id="pon-a-prueba-lo-que-aprendiste">Pon a Prueba Lo Que Aprendiste</h2>
<hr />
<h2 id="tu-mision">üéØ Tu Misi√≥n</h2>
<p>Vas a a√±adir un nuevo endpoint <strong>por tu cuenta</strong> que devuelva un vinilo espec√≠fico por su ID:</p>
<div class="highlight"><pre><span></span><code>GET /vinilos          ‚Üê Ya existe (devuelve todos)
POST /vinilos         ‚Üê Ya existe (crea uno)
GET /vinilos/{id}     ‚Üê T√ö VAS A CREAR ESTO
</code></pre></div>

<p><strong>Ejemplo de uso</strong>:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>https://xxx.execute-api.eu-west-1.amazonaws.com/vinilos/1
</code></pre></div>

<p><strong>Respuesta esperada</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;vinilo&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;titulo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Abbey Road&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;artista&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;The Beatles&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;precio&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">25.99</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;a√±o&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1969</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;imagen&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://...&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="requisitos">üìã Requisitos</h2>
<p>Tu implementaci√≥n debe:</p>
<ol>
<li>‚úÖ Aceptar un par√°metro <code>{id}</code> en la ruta</li>
<li>‚úÖ Buscar el vinilo en DynamoDB por ID</li>
<li>‚úÖ Devolver <strong>200</strong> si existe</li>
<li>‚úÖ Devolver <strong>404</strong> si no existe</li>
<li>‚úÖ Devolver <strong>500</strong> si hay error de servidor</li>
</ol>
<hr />
<h2 id="pistas-generales">üí° Pistas Generales</h2>
<h3 id="pista-1-estructura-general">Pista 1: Estructura General</h3>
<p>Vas a necesitar:<br />
1. Nuevo handler en <code>src/handlers/get-vinilo-by-id/</code><br />
2. Actualizar <code>template.yaml</code> con la nueva funci√≥n<br />
3. Configurar ruta con par√°metro din√°mico en API Gateway</p>
<h3 id="pista-2-diferencias-con-get-todos">Pista 2: Diferencias con GET todos</h3>
<table>
<thead>
<tr>
<th>GET /vinilos (todos)</th>
<th>GET /vinilos/{id} (uno)</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ScanCommand</code></td>
<td><code>GetCommand</code></td>
</tr>
<tr>
<td>No recibe par√°metros</td>
<td>Recibe <code>id</code> del path</td>
</tr>
<tr>
<td>Devuelve array</td>
<td>Devuelve un objeto</td>
</tr>
<tr>
<td>Siempre 200 (aunque vac√≠o)</td>
<td>200 si existe, 404 si no</td>
</tr>
</tbody>
</table>
<h3 id="pista-3-operaciones-dynamodb">Pista 3: Operaciones DynamoDB</h3>
<div class="highlight"><pre><span></span><code><span class="c1">// GET todos (ya lo tienes)</span>
<span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ScanCommand</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@aws-sdk/lib-dynamodb&#39;</span><span class="p">);</span>

<span class="c1">// GET by ID (necesitas esto)</span>
<span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">GetCommand</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@aws-sdk/lib-dynamodb&#39;</span><span class="p">);</span>
</code></pre></div>

<hr />
<h2 id="paso-a-paso-sin-codigo-completo">üó∫Ô∏è Paso a Paso (Sin C√≥digo Completo)</h2>
<h3 id="paso-1-crear-handler">Paso 1: Crear Handler</h3>
<p>Crea: <code>src/handlers/get-vinilo-by-id/index.js</code></p>
<p><strong>Estructura base</strong> (t√∫ completas los TODOs):</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">DynamoDBClient</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@aws-sdk/client-dynamodb&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">DynamoDBDocumentClient</span><span class="p">,</span><span class="w"> </span><span class="nx">GetCommand</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@aws-sdk/lib-dynamodb&#39;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">ddbClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DynamoDBClient</span><span class="p">({</span><span class="w"> </span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">REGION</span><span class="w"> </span><span class="p">});</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">docClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">DynamoDBDocumentClient</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">ddbClient</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">TABLE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">TABLE_NAME</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">handler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Lambda invocada - GET vinilo by ID&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Event:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">));</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// TODO 1: Obtener el ID del path parameter</span>
<span class="w">        </span><span class="c1">// Pista: event.pathParameters contiene los par√°metros de la ruta</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">// ... completa aqu√≠</span>

<span class="w">        </span><span class="c1">// TODO 2: Validar que el ID existe</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="mf">400</span><span class="p">,</span>
<span class="w">                </span><span class="c1">// ... completa la respuesta</span>
<span class="w">            </span><span class="p">};</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// TODO 3: Buscar en DynamoDB por ID</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">TableName</span><span class="o">:</span><span class="w"> </span><span class="nx">TABLE_NAME</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Key</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// ... completa aqu√≠ (clave primaria)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">docClient</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">GetCommand</span><span class="p">(</span><span class="nx">params</span><span class="p">));</span>

<span class="w">        </span><span class="c1">// TODO 4: Verificar si el item existe</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">Item</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="mf">404</span><span class="p">,</span>
<span class="w">                </span><span class="c1">// ... completa la respuesta (vinilo no encontrado)</span>
<span class="w">            </span><span class="p">};</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// TODO 5: Construir la URL de la imagen S3</span>
<span class="w">        </span><span class="c1">// Pista: Usa process.env.BUCKET_NAME y process.env.REGION</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">s3BaseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="c1">// ... completa aqu√≠</span>

<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">vinilo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="p">...</span><span class="nx">result</span><span class="p">.</span><span class="nx">Item</span><span class="p">,</span>
<span class="w">            </span><span class="nx">imagen</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">s3BaseUrl</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">result</span><span class="p">.</span><span class="nx">Item</span><span class="p">.</span><span class="nx">imagen_key</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;placeholder.jpg&#39;</span><span class="si">}</span><span class="sb">`</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="c1">// TODO 6: Devolver respuesta exitosa</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="mf">200</span><span class="p">,</span>
<span class="w">            </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
<span class="w">                </span><span class="nx">vinilo</span><span class="o">:</span><span class="w"> </span><span class="nx">vinilo</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="mf">500</span><span class="p">,</span>
<span class="w">            </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
<span class="w">                </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Error al obtener vinilo&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">mensaje</span><span class="o">:</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
</code></pre></div>

<p><strong>Crea tambi√©n</strong>: <code>src/handlers/get-vinilo-by-id/package.json</code></p>
<details>
<summary>üí° Ver package.json (click para expandir)</summary>


<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;get-vinilo-by-id-handler&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Lambda handler for getting a vinyl record by ID&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;main&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;index.js&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;dependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;@aws-sdk/client-dynamodb&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^3.700.0&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;@aws-sdk/lib-dynamodb&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^3.700.0&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


</details>

<hr />
<h3 id="paso-2-actualizar-templateyaml">Paso 2: Actualizar template.yaml</h3>
<p>A√±ade esta funci√≥n <strong>despu√©s de</strong> <code>CreateViniloFunction</code>:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nt">GetViniloByIdFunction</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::Serverless::Function</span>
<span class="w">    </span><span class="nt">Properties</span><span class="p">:</span>
<span class="w">      </span><span class="nt">FunctionName</span><span class="p">:</span><span class="w"> </span><span class="kt">!Sub</span><span class="w"> </span><span class="s">&#39;${StudentPrefix}-get-vinilo-by-id&#39;</span>
<span class="w">      </span><span class="nt">CodeUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src/handlers/get-vinilo-by-id/</span>
<span class="w">      </span><span class="nt">Handler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">index.handler</span>
<span class="w">      </span><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Returns a specific vinyl record by ID</span>
<span class="w">      </span><span class="nt">Policies</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">DynamoDBReadPolicy</span><span class="p">:</span>
<span class="w">            </span><span class="nt">TableName</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VinilosTable</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">S3ReadPolicy</span><span class="p">:</span>
<span class="w">            </span><span class="nt">BucketName</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VinilosImagenesBucket</span>
<span class="w">      </span><span class="nt">Events</span><span class="p">:</span>
<span class="w">        </span><span class="nt">GetViniloById</span><span class="p">:</span>
<span class="w">          </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HttpApi</span>
<span class="w">          </span><span class="nt">Properties</span><span class="p">:</span>
<span class="w">            </span><span class="c1"># TODO: Completa la ruta con par√°metro din√°mico</span>
<span class="w">            </span><span class="nt">Path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/vinilos/{id}</span><span class="w">    </span><span class="c1"># ‚Üê F√≠jate en la sintaxis {id}</span>
<span class="w">            </span><span class="nt">Method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">get</span>
<span class="w">            </span><span class="nt">ApiId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VinilosHttpApi</span>
</code></pre></div>

<p><strong>A√±ade tambi√©n el Output</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nt">GetViniloByIdFunctionArn</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Lambda Function ARN (GET by ID)</span>
<span class="w">    </span><span class="nt">Value</span><span class="p">:</span><span class="w"> </span><span class="kt">!GetAtt</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GetViniloByIdFunction.Arn</span>
<span class="w">    </span><span class="nt">Export</span><span class="p">:</span>
<span class="w">      </span><span class="nt">Name</span><span class="p">:</span><span class="w"> </span><span class="kt">!Sub</span><span class="w"> </span><span class="s">&#39;${StudentPrefix}-GetViniloByIdFunctionArn&#39;</span>
</code></pre></div>

<hr />
<h3 id="paso-3-build-y-deploy">Paso 3: Build y Deploy</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Instalar dependencias</span>
<span class="nb">cd</span><span class="w"> </span>src/handlers/get-vinilo-by-id
npm<span class="w"> </span>install
<span class="nb">cd</span><span class="w"> </span>../../..

<span class="c1"># Build</span>
sam<span class="w"> </span>build

<span class="c1"># Deploy</span>
sam<span class="w"> </span>deploy
</code></pre></div>

<hr />
<h3 id="paso-4-probar">Paso 4: Probar</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Obtener URL</span>
<span class="nv">API_URL</span><span class="o">=</span><span class="k">$(</span>aws<span class="w"> </span>cloudformation<span class="w"> </span>describe-stacks<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--stack-name<span class="w"> </span><span class="o">{</span>tu-prefijo<span class="o">}</span>-vinilos-stack<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--query<span class="w"> </span><span class="s1">&#39;Stacks[0].Outputs[?OutputKey==`VinilosApiUrl`].OutputValue&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output<span class="w"> </span>text<span class="k">)</span>

<span class="c1"># Probar con ID existente (debe devolver 200)</span>
curl<span class="w"> </span><span class="nv">$API_URL</span>/1

<span class="c1"># Probar con ID inexistente (debe devolver 404)</span>
curl<span class="w"> </span><span class="nv">$API_URL</span>/999
</code></pre></div>

<hr />
<h2 id="tests-de-validacion">üß™ Tests de Validaci√≥n</h2>
<p>Tu implementaci√≥n debe pasar estos tests:</p>
<h3 id="test-1-vinilo-existente">Test 1: Vinilo Existente</h3>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>https://xxx.../vinilos/1
</code></pre></div>

<p><strong>Esperado</strong>: Status 200, JSON con el vinilo "Abbey Road"</p>
<h3 id="test-2-vinilo-inexistente">Test 2: Vinilo Inexistente</h3>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>https://xxx.../vinilos/999
</code></pre></div>

<p><strong>Esperado</strong>: Status 404, mensaje "Vinilo no encontrado"</p>
<h3 id="test-3-id-vacio">Test 3: ID Vac√≠o</h3>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>https://xxx.../vinilos/
</code></pre></div>

<p><strong>Esperado</strong>: Status 404 (API Gateway - ruta no encontrada) o 400 (si validas en Lambda)</p>
<h3 id="test-4-otro-vinilo-existente">Test 4: Otro Vinilo Existente</h3>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>https://xxx.../vinilos/3
</code></pre></div>

<p><strong>Esperado</strong>: Status 200, JSON con el vinilo "Thriller"</p>
<hr />
<h2 id="pistas-especificas">üí° Pistas Espec√≠ficas</h2>
<details>
<summary>üîç Pista: C√≥mo obtener el ID del path</summary>


<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">pathParameters</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
</code></pre></div>



API Gateway pone los par√°metros de ruta en `event.pathParameters`.
</details>

<details>
<summary>üîç Pista: C√≥mo buscar por ID en DynamoDB</summary>


<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">TableName</span><span class="o">:</span><span class="w"> </span><span class="nx">TABLE_NAME</span><span class="p">,</span>
<span class="w">    </span><span class="nx">Key</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="nx">id</span><span class="w">  </span><span class="c1">// Clave primaria de tu tabla</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">docClient</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">GetCommand</span><span class="p">(</span><span class="nx">params</span><span class="p">));</span>
</code></pre></div>



`GetCommand` busca por clave primaria (m√°s eficiente que Scan).
</details>

<details>
<summary>üîç Pista: C√≥mo verificar si existe</summary>


<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">Item</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// El vinilo no existe</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="mf">404</span><span class="p">,</span>
<span class="w">        </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
<span class="w">            </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Vinilo no encontrado&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="nx">mensaje</span><span class="o">:</span><span class="w"> </span><span class="sb">`No existe vinilo con ID: </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>



`GetCommand` devuelve `undefined` en `result.Item` si no encuentra el item.
</details>

<details>
<summary>üîç Pista: URL de imagen S3</summary>


<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">s3BaseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`https://</span><span class="si">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">BUCKET_NAME</span><span class="si">}</span><span class="sb">.s3.</span><span class="si">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">REGION</span><span class="si">}</span><span class="sb">.amazonaws.com`</span><span class="p">;</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">vinilo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">...</span><span class="nx">result</span><span class="p">.</span><span class="nx">Item</span><span class="p">,</span>
<span class="w">    </span><span class="nx">imagen</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">s3BaseUrl</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">result</span><span class="p">.</span><span class="nx">Item</span><span class="p">.</span><span class="nx">imagen_key</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;placeholder.jpg&#39;</span><span class="si">}</span><span class="sb">`</span>
<span class="p">};</span>
</code></pre></div>



Igual que en `get-vinilos`, pero aplicado a un solo item.
</details>

<hr />
<h2 id="documentacion-util">üìö Documentaci√≥n √ötil</h2>
<h3 id="getcommand-vs-scancommand">GetCommand vs ScanCommand</h3>
<table>
<thead>
<tr>
<th>Comando</th>
<th>Uso</th>
<th>Performance</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>GetCommand</strong></td>
<td>Buscar por clave primaria</td>
<td>‚ö° R√°pido (O(1))</td>
</tr>
<tr>
<td><strong>ScanCommand</strong></td>
<td>Leer todos los items</td>
<td>üê¢ Lento (O(n))</td>
</tr>
</tbody>
</table>
<p><strong>Regla</strong>: Usa <code>GetCommand</code> cuando <strong>sabes el ID exacto</strong>.</p>
<h3 id="path-parameters-en-api-gateway">Path Parameters en API Gateway</h3>
<p><strong>Definici√≥n en template</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">Path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/vinilos/{id}</span><span class="w">    </span><span class="c1"># {id} es variable</span>
</code></pre></div>

<p><strong>Acceso en Lambda</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">pathParameters</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
</code></pre></div>

<p><strong>Ejemplo de event</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;pathParameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;requestContext&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;http&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/vinilos/1&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h2 id="checklist-de-autocomprobacion">‚úÖ Checklist de Autocomprobaci√≥n</h2>
<p>Antes de ver la soluci√≥n, verifica:</p>
<ul>
<li>[ ] Handler creado en <code>src/handlers/get-vinilo-by-id/</code></li>
<li>[ ] <code>package.json</code> creado con dependencias correctas</li>
<li>[ ] Dependencias instaladas (<code>npm install</code>)</li>
<li>[ ] Funci√≥n a√±adida a <code>template.yaml</code> con ruta <code>/vinilos/{id}</code></li>
<li>[ ] Output a√±adido para la nueva funci√≥n</li>
<li>[ ] Build ejecutado sin errores</li>
<li>[ ] Deploy completado (stack updated)</li>
<li>[ ] Test 1 pasa (vinilo existente devuelve 200)</li>
<li>[ ] Test 2 pasa (vinilo inexistente devuelve 404)</li>
<li>[ ] Logs visibles con <code>sam logs</code></li>
</ul>
<hr />
<h2 id="necesitas-la-solucion">üéì ¬øNecesitas la Soluci√≥n?</h2>
<p>Si completaste el ejercicio (o te atascaste), puedes ver la <strong>soluci√≥n completa</strong>:</p>
<h3 id="opcion-1-ver-solucion-en-github">Opci√≥n 1: Ver Soluci√≥n en GitHub</h3>
<p>La soluci√≥n est√° en la rama <code>modulo-1-sam-completo</code>:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>fetch<span class="w"> </span>origin
git<span class="w"> </span>checkout<span class="w"> </span>modulo-1-sam-completo
</code></pre></div>

<p>Esta rama incluye:<br />
- ‚úÖ C√≥digo completo del handler <code>get-vinilo-by-id</code><br />
- ‚úÖ Template actualizado<br />
- ‚úÖ Tests de validaci√≥n</p>
<h3 id="opcion-2-ver-solucion-aqui-abajo">Opci√≥n 2: Ver Soluci√≥n Aqu√≠ Abajo</h3>
<details>
<summary>üìñ SOLUCI√ìN COMPLETA - Click para expandir</summary>

## C√≥digo Completo: `src/handlers/get-vinilo-by-id/index.js`


<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * Get Vinilo By ID Handler</span>
<span class="cm"> *</span>
<span class="cm"> * Returns a specific vinyl record by ID from DynamoDB</span>
<span class="cm"> */</span>

<span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">DynamoDBClient</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@aws-sdk/client-dynamodb&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">DynamoDBDocumentClient</span><span class="p">,</span><span class="w"> </span><span class="nx">GetCommand</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@aws-sdk/lib-dynamodb&#39;</span><span class="p">);</span>

<span class="c1">// Initialize DynamoDB Document Client</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">ddbClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">DynamoDBClient</span><span class="p">({</span><span class="w"> </span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">REGION</span><span class="w"> </span><span class="p">});</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">docClient</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">DynamoDBDocumentClient</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">ddbClient</span><span class="p">);</span>

<span class="c1">// Environment variables</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">TABLE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">TABLE_NAME</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">BUCKET_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">BUCKET_NAME</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">REGION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">REGION</span><span class="p">;</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">handler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Lambda invocada - GET vinilo by ID&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Event:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">));</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Extract ID from path parameters</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">pathParameters</span><span class="o">?</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Validate ID</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="mf">400</span><span class="p">,</span>
<span class="w">                </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
<span class="w">                    </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;ID requerido&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">mensaje</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Debes proporcionar un ID en la ruta&#39;</span>
<span class="w">                </span><span class="p">})</span>
<span class="w">            </span><span class="p">};</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Buscando vinilo con ID:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Get item from DynamoDB by ID</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">TableName</span><span class="o">:</span><span class="w"> </span><span class="nx">TABLE_NAME</span><span class="p">,</span>
<span class="w">            </span><span class="nx">Key</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="nx">id</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">docClient</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">GetCommand</span><span class="p">(</span><span class="nx">params</span><span class="p">));</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;DynamoDB GetItem result:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">Item</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;Found&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Not found&#39;</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Check if item exists</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">result</span><span class="p">.</span><span class="nx">Item</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="mf">404</span><span class="p">,</span>
<span class="w">                </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
<span class="w">                    </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Vinilo no encontrado&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">mensaje</span><span class="o">:</span><span class="w"> </span><span class="sb">`No existe vinilo con ID: </span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span>
<span class="w">                </span><span class="p">})</span>
<span class="w">            </span><span class="p">};</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Build S3 image URL</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">s3BaseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`https://</span><span class="si">${</span><span class="nx">BUCKET_NAME</span><span class="si">}</span><span class="sb">.s3.</span><span class="si">${</span><span class="nx">REGION</span><span class="si">}</span><span class="sb">.amazonaws.com`</span><span class="p">;</span>

<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">vinilo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="p">...</span><span class="nx">result</span><span class="p">.</span><span class="nx">Item</span><span class="p">,</span>
<span class="w">            </span><span class="nx">imagen</span><span class="o">:</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">s3BaseUrl</span><span class="si">}</span><span class="sb">/</span><span class="si">${</span><span class="nx">result</span><span class="p">.</span><span class="nx">Item</span><span class="p">.</span><span class="nx">imagen_key</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;placeholder.jpg&#39;</span><span class="si">}</span><span class="sb">`</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="c1">// Return successful response</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="mf">200</span><span class="p">,</span>
<span class="w">            </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
<span class="w">                </span><span class="nx">vinilo</span><span class="o">:</span><span class="w"> </span><span class="nx">vinilo</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error al obtener vinilo:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">statusCode</span><span class="o">:</span><span class="w"> </span><span class="mf">500</span><span class="p">,</span>
<span class="w">            </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="s1">&#39;Access-Control-Allow-Origin&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
<span class="w">                </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Error al obtener vinilo&#39;</span><span class="p">,</span>
<span class="w">                </span><span class="nx">mensaje</span><span class="o">:</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="p">,</span>
<span class="w">                </span><span class="nx">tipo</span><span class="o">:</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">name</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">};</span>
</code></pre></div>



## Template Actualizado


<div class="highlight"><pre><span></span><code><span class="w">  </span><span class="nt">GetViniloByIdFunction</span><span class="p">:</span>
<span class="w">    </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AWS::Serverless::Function</span>
<span class="w">    </span><span class="nt">Properties</span><span class="p">:</span>
<span class="w">      </span><span class="nt">FunctionName</span><span class="p">:</span><span class="w"> </span><span class="kt">!Sub</span><span class="w"> </span><span class="s">&#39;${StudentPrefix}-get-vinilo-by-id&#39;</span>
<span class="w">      </span><span class="nt">CodeUri</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">src/handlers/get-vinilo-by-id/</span>
<span class="w">      </span><span class="nt">Handler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">index.handler</span>
<span class="w">      </span><span class="nt">Description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Returns a specific vinyl record by ID</span>
<span class="w">      </span><span class="nt">Policies</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">DynamoDBReadPolicy</span><span class="p">:</span>
<span class="w">            </span><span class="nt">TableName</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VinilosTable</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">S3ReadPolicy</span><span class="p">:</span>
<span class="w">            </span><span class="nt">BucketName</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VinilosImagenesBucket</span>
<span class="w">      </span><span class="nt">Events</span><span class="p">:</span>
<span class="w">        </span><span class="nt">GetViniloById</span><span class="p">:</span>
<span class="w">          </span><span class="nt">Type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HttpApi</span>
<span class="w">          </span><span class="nt">Properties</span><span class="p">:</span>
<span class="w">            </span><span class="nt">Path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/vinilos/{id}</span>
<span class="w">            </span><span class="nt">Method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">get</span>
<span class="w">            </span><span class="nt">ApiId</span><span class="p">:</span><span class="w"> </span><span class="kt">!Ref</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">VinilosHttpApi</span>
</code></pre></div>



</details>

<hr />
<h2 id="felicidades">üéâ ¬°Felicidades!</h2>
<p>Si completaste este ejercicio por tu cuenta, has demostrado que:</p>
<p>‚úÖ Entiendes la estructura de una aplicaci√≥n SAM<br />
‚úÖ Sabes a√±adir recursos nuevos al template<br />
‚úÖ Comprendes la diferencia entre Scan y GetCommand<br />
‚úÖ Manejas path parameters en API Gateway<br />
‚úÖ Sabes devolver c√≥digos de estado HTTP apropiados</p>
<p><strong>Est√°s listo para desarrollar aplicaciones serverless reales.</strong> üöÄ</p>
<hr />
<h2 id="resumen-endpoints-completos">üìä Resumen: Endpoints Completos</h2>
<p>Tu API ahora tiene <strong>3 endpoints</strong>:</p>
<table>
<thead>
<tr>
<th>M√©todo</th>
<th>Ruta</th>
<th>Qu√© Hace</th>
<th>Handler</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td><code>/vinilos</code></td>
<td>Lista todos los vinilos</td>
<td><code>get-vinilos</code></td>
</tr>
<tr>
<td>POST</td>
<td><code>/vinilos</code></td>
<td>Crea un vinilo</td>
<td><code>create-vinilo</code></td>
</tr>
<tr>
<td>GET</td>
<td><code>/vinilos/{id}</code></td>
<td>Obtiene un vinilo espec√≠fico</td>
<td><code>get-vinilo-by-id</code></td>
</tr>
</tbody>
</table>
<p><strong>Arquitectura final</strong>:</p>
<div class="highlight"><pre><span></span><code>                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                     ‚îÇ   API Gateway    ‚îÇ
                     ‚îÇ  (HTTP API)      ‚îÇ
                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ                ‚îÇ                ‚îÇ
              ‚Üì                ‚Üì                ‚Üì
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      ‚îÇ   Lambda     ‚îÇ  ‚îÇ   Lambda     ‚îÇ  ‚îÇ   Lambda     ‚îÇ
      ‚îÇ get-vinilos  ‚îÇ  ‚îÇcreate-vinilo ‚îÇ  ‚îÇget-vinilo-id ‚îÇ
      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ                ‚îÇ                  ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ
                               ‚Üì
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ  DynamoDB    ‚îÇ
                       ‚îÇ   vinilos    ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</code></pre></div>

<p><strong>Pr√≥ximos m√≥dulos</strong>: Seguridad, vulnerabilidades, autenticaci√≥n, autorizaci√≥n... ¬°Queda mucho por aprender!</p>
        </div>
    </div>

    <!-- JavaScript for student prefix management -->
    <script src="../scripts/student-prefix.js"></script>
    <!-- JavaScript for sidebar navigation -->
    <script src="../scripts/sidebar-nav.js"></script>
    <!-- JavaScript for copy code buttons -->
    <script src="../scripts/copy-code.js"></script>
</body>
</html>